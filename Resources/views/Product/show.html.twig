{% extends '@SyliusShop/layout.html.twig' %}

{% block content %}
{% include '@SyliusShop/Product/Show/_breadcrumb.html.twig' %}
<div class="ui hidden divider"></div>

<div class="ui two column stackable grid">
    <div class="column">
        {% include '@SyliusShop/Product/Show/_images.html.twig' %}
    </div>
    <div class="column">
        {% include '@SyliusShop/Product/Show/_header.html.twig' %}
        <div class="ui stackable grid">
            <div class="four wide column">
                {% include '@SyliusShop/Product/Show/_price.html.twig' %}
            </div>
            <div class="twelve wide right aligned column">
                <span class="ui sub header">{{ product.code }}</span>
            </div>
        </div>
        <div class="ui basic segment">
            <p>{{ product.shortDescription }}</p>
        </div>
        <div class="ui segment">
            {% include '@SyliusShop/Product/Show/_variantsPrices.html.twig' with { 'variantsPrices': variantsPrices } %}
            {% include '@SyliusShop/Product/Show/_inventory.html.twig' %}
        </div>
        <div class="ui hidden divider"></div>
    </div>
</div>

<div class="ui hidden divider"></div>

<div class="ui top attached large tabular menu">
    {% include '@SyliusShop/Product/Show/_menu.html.twig' %}
</div>
{% include '@SyliusShop/Product/Show/_tabs.html.twig' %}

{% include '@SyliusShop/Product/Show/_associations.html.twig' %}
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script>
        $(document).ready(function() {
            if ($('#variantsPrices').length > 0) {
                $('[name*="sylius_cart_item[variant]"]').on('change', function() {
                    $selector = '';

                    $('#sylius-product-adding-to-cart select').each(function() {
                        $selector += '[data-'+$(this).attr('data-option')+'="'+$(this).find('option:selected').text()+'"]';
                    });

                    $price = $($selector).attr('data-value');
                    if ($price !== undefined) {
                        $('#product-price').text($price);
                    } else {
                        $('#product-price').text('unavailable');
                    }
                });
            }
        });
    </script>
{% endblock %}
